"use strict";(self.webpackChunk_nand2tetris_web=self.webpackChunk_nand2tetris_web||[]).push([[519],{5519:(e,t,s)=>{s.r(t),s.d(t,{Asm:()=>w,default:()=>C});var n=s(1391),r=s(7022),a=s(910),i=s(782),l=s(135);const o=({values:e=[],highlight:t=-1,onClick:s})=>(0,i.jsx)("div",{children:e.map(((e,n)=>(0,i.jsx)(d,{identifier:e.name,value:e.value,highlight:n===t,onClick:()=>s?.(e.name,e.value)},n)))}),d=({identifier:e,value:t,highlight:s=!1,onClick:n})=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},onClick:n,children:[e.length>0&&(0,i.jsx)("code",{style:{flex:"1",...(0,l.Wf)("none"),...s?{background:"var(--mark-background-color)"}:{},whiteSpace:"pre",padding:"3px"},children:e}),t.length>0&&(0,i.jsx)("code",{style:{flex:"1",textAlign:"right",padding:"3px",...(0,l.Wf)("none"),...s?{background:"var(--mark-background-color)"}:{}},children:t})]});var c=s(4666),u=s(9547),h=s(1091),p=s(8878),m=s(2675),g=s(5168),x=s(2144),f=s(7076),v=s(8330),j=s(8029),b=s(384),y=s(3499);const w=()=>{const{filePicker:e}=(0,p.useContext)(j.BR),{stores:t,setTool:s}=(0,p.useContext)(b.NQ),{state:l,actions:d,dispatch:w}=t.asm,C=(0,p.useRef)(0),k=(0,p.useRef)(0),N=(0,p.useRef)(),[R,T]=(0,p.useState)(!1),[L,S]=(0,p.useState)(!0);(0,p.useEffect)((()=>{s("asm")}),[s]),(0,p.useEffect)((()=>(N.current=new class extends h.M{async tick(){return C.current=0,k.current=0,d.step()}reset(){d.reset()}toggle(){}},T(!0),()=>{var e;null===(e=N.current)||void 0===e||e.stop()})),[d,w]);const F=(0,p.useRef)(null),E=(0,p.useRef)(null),{setStatus:P}=(0,p.useContext)(a.L),U=(e,t)=>{const s=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(s);F.current&&(F.current.href=n,F.current.download=t,F.current.click(),URL.revokeObjectURL(n))};return(0,i.jsxs)("div",{className:"AsmPage grid "+(L?"":"hide-sym"),children:[(0,i.jsx)(g.Z,{className:"source",isEditorPanel:!0,header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)(n.x6,{id:"wdxz7K"})}),(0,i.jsx)("div",{className:"flex-1",children:R&&N.current&&(0,i.jsx)(r.T,{runner:N.current,disabled:void 0!=l.error,prefix:(0,i.jsx)("button",{className:"flex-0",onClick:async()=>{const t=await e.select({suffix:".asm"});P(x.F),requestAnimationFrame((async()=>{var e;await d.loadAsm(t),P(""),w.current({action:"setTitle",payload:null!==(e=t.split("/").pop())&&void 0!==e?e:""})}))},"data-tooltip":"Load file","data-placement":"bottom",children:"\ud83d\udcc2"}),overrideTooltips:{step:"Translate",run:"Translate all"},speed:l.config.speed,onSpeedChange:e=>{w.current({action:"updateConfig",payload:{speed:e}}),d.setAnimate(e<=2)}})}),(0,i.jsx)("fieldset",{role:"group",children:(0,i.jsx)("button",{"data-tooltip":"Download","data-placement":"left",onClick:()=>{var e,t;return U(l.asm,null!==(e=null===(t=l.path)||void 0===t?void 0:t.split("/").pop())&&void 0!==e?e:"source.asm")},children:"\u2b07\ufe0f"})})]}),children:(0,i.jsx)(m.K,{value:l.asm,error:l.error,alwaysRecenter:!1,onChange:e=>{d.setAsm(e)},onCursorPositionChange:e=>{e!=C.current&&(C.current=e,setTimeout((()=>{d.updateHighlight(e,!0)}),100))},grammar:c.y0.parser,language:"asm",highlight:l.translating?l.sourceHighlight:void 0,lineNumberTransform:e=>{if(!l.translating)return"";const t=l.lineNumbers[e];return(void 0===t?"":t).toString()}})}),(0,i.jsx)(g.Z,{className:"result",isEditorPanel:!0,header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)(n.x6,{id:"BUAJAb"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("a",{ref:F,style:{display:"none"}}),(0,i.jsx)(v.N_,{ref:E,style:{display:"none"},to:y.Ay.cpu.href}),(0,i.jsxs)("fieldset",{role:"group",children:[(0,i.jsx)("button",{"data-tooltip":"Load to the CPU Emulator","data-placement":"left",onClick:async()=>{var e;const s=await(0,u.aU)(l.result),n=new f.n9;var r;(await n.loadBytes(s),t.cpu.actions.replaceROM(n),l.path)&&(t.cpu.dispatch.current({action:"setTitle",payload:null!==(r=l.path.split("/").pop())&&void 0!==r?r:""}),t.cpu.actions.setPath(l.path),t.cpu.actions.reset());null===(e=E.current)||void 0===e||e.click()},children:"\u21a9\ufe0f"}),(0,i.jsx)("button",{"data-tooltip":"Download","data-placement":"left",onClick:()=>{var e,t,s;return U(l.result,null!==(e=null===(t=l.path)||void 0===t||null===(s=t.split("/").pop())||void 0===s?void 0:s.replace(".asm",".hack"))&&void 0!==e?e:"result.hack")},children:"\u2b07\ufe0f"})]})]})]}),children:(0,i.jsx)(m.K,{value:l.result,highlight:l.resultHighlight,disabled:!0,onChange:function(e){},onCursorPositionChange:e=>{e!=k.current&&(k.current=e,d.updateHighlight(e,!1))},grammar:void 0,language:"",alwaysRecenter:!1,lineNumberTransform:e=>(e-1).toString()})}),(0,i.jsx)(g.Z,{className:"sym",isEditorPanel:!0,header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(n.x6,{id:"LWSJ0G"})}),(0,i.jsx)("input",{type:"checkbox",role:"switch",checked:L,onChange:()=>S(!L)})]}),children:l.translating&&L&&(0,i.jsx)(o,{values:l.symbols})}),(0,i.jsx)(g.Z,{className:"compare",header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(n.x6,{id:"UV+b1H"}),l.compareName&&`: ${l.compareName}`]}),(0,i.jsx)("div",{children:(0,i.jsx)("fieldset",{role:"group",children:(0,i.jsx)("button",{onClick:()=>{d.compare()},children:"Compare"})})})]}),children:(0,i.jsx)(m.K,{value:l.compare,highlight:l.translating?l.resultHighlight:void 0,highlightType:l.compareError?"error":"highlight",alwaysRecenter:!1,onChange:function(e){w.current({action:"setCmp",payload:{cmp:e}})},onCursorPositionChange:e=>{e!=k.current&&(k.current=e,d.updateHighlight(e,!1))},language:"",lineNumberTransform:e=>(e-1).toString()})})]})},C=w},2675:(e,t,s)=>{s.d(t,{K:()=>c});var n=s(1391),r=s(8878),a=s(8029),i=s(782);const l=(0,r.lazy)((()=>Promise.all([s.e(983),s.e(265),s.e(965)]).then(s.bind(s,8965)))),o=({error:e})=>e?(0,i.jsxs)("details",{className:"ErrorPanel",open:!0,children:[(0,i.jsx)("summary",{role:"button",className:"secondary",children:(0,i.jsx)(n.x6,{id:"1tSpqV"})}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:null===e||void 0===e?void 0:e.message})})]}):(0,i.jsx)(i.Fragment,{}),d=({value:e,onChange:t,language:s,disabled:n=!1})=>{const[a,l]=(0,r.useState)(e);return(0,i.jsx)("textarea",{"data-testid":`editor-${s}`,disabled:n,value:a,onChange:e=>{var s;const n=null===(s=e.target)||void 0===s?void 0:s.value;l(n),t(n)}})},c=({className:e="",style:t={},disabled:s=!1,value:n,error:c,onChange:u,onCursorPositionChange:h,grammar:p,language:m,highlight:g,highlightType:x="highlight",customDecorations:f=[],dynamicHeight:v=!1,alwaysRecenter:j=!0,lineNumberTransform:b})=>{const{monaco:y}=(0,r.useContext)(a.BR);return(0,i.jsx)("div",{className:`Editor ${v?"dynamic-height":""} ${e}`,style:t,children:y.canUse&&y.wants?(0,i.jsx)(r.Suspense,{fallback:"Loading...",children:(0,i.jsx)(l,{value:n,onChange:u,onCursorPositionChange:h,language:m,error:c,disabled:s,highlight:g,highlightType:x,customDecorations:f,dynamicHeight:v,alwaysRecenter:j,lineNumberTransform:b})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d,{value:n,onChange:u,language:m,disabled:s}),(0,i.jsx)(o,{error:c})]})})}},5168:(e,t,s)=>{s.d(t,{p:()=>a,Z:()=>r});var n=s(782);const r=e=>{var t;return(0,n.jsxs)("article",{className:["panel",null!==(t=e.className)&&void 0!==t?t:"",e.isEditorPanel?"editor":""].join(" "),children:[e.header&&(0,n.jsx)("header",{children:e.header}),(0,n.jsx)("main",{children:e.children}),e.footer&&(0,n.jsx)("footer",{children:e.footer})]})},a=e=>{var t;return(0,n.jsxs)("details",{className:null!==(t=e.className)&&void 0!==t?t:"",open:e.open,style:e.style,children:[(0,n.jsx)("summary",{children:(0,n.jsx)("div",{className:"flex row align-baseline",children:e.summary})}),e.children]})}},2144:(e,t,s)=>{s.d(t,{F:()=>n});const n="Loading in progress..."},7022:(e,t,s)=>{s.d(t,{T:()=>i});var n=s(782),r=s(8878),a=s(9646);const i=e=>{const t=function(e){const t=(0,r.useRef)((()=>{})),{initialState:s,reducers:n,actions:i}=(0,r.useMemo)((()=>((e,t)=>{const s={running:e.running,speed:e.speed,steps:e.steps},n=e.finishFrame.bind(e);return e.finishFrame=function(){n(),t.current({action:"update"})},{initialState:s,reducers:{update(t){t.running=e.running,t.speed=e.speed,t.steps=e.steps},setSteps(t,s){t.steps=s,e.steps=s},setSpeed(t,s){t.speed=s,e.speed=s}},actions:{frame(){e.frame()},start(){e.start(),t.current({action:"update"})},stop(){e.stop(),t.current({action:"update"})},reset(){e.reset(),t.current({action:"update"})}}}})(e,t)),[e,t]),[l,o]=(0,a.A)(n,s);return t.current=o,{state:l,dispatch:t.current,actions:i}}(e.runner),[s,i]=(0,a.b)(e.speed??2),l={0:[1e3,1],1:[500,1],2:[16,1],3:[16,16666],4:[16,499980]};(0,r.useEffect)((()=>{o()}),[s]);const o=()=>{const[e,n]=l[s];t.dispatch({action:"setSpeed",payload:e}),t.dispatch({action:"setSteps",payload:n})},d=(0,r.useRef)(null),c=e=>{d.current?.blur()};return(0,r.useEffect)((()=>(window.addEventListener("keydown",c),window.addEventListener("keyup",c),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",c)}))),(0,n.jsxs)("div",{className:"flex row wrap",children:[(0,n.jsxs)("fieldset",{role:"group",children:[e.prefix,(0,n.jsx)("button",{className:"flex-0",disabled:e.disabled,onClick:()=>t.actions.frame(),"data-tooltip":e.overrideTooltips?.step??"Step","data-placement":"bottom",children:"\u27a1\ufe0f"}),(0,n.jsx)("button",{className:"flex-0",ref:d,disabled:e.disabled,onClick:()=>t.state.running?t.actions.stop():t.actions.start(),"data-tooltip":t.state.running?e.overrideTooltips?.pause??"Pause":e.overrideTooltips?.run??"Run","data-placement":"bottom",children:t.state.running?"\u23f8":"\ufe0f\u23e9"}),(0,n.jsx)("button",{className:"flex-0",onClick:()=>{t.state.running&&t.actions.stop(),t.actions.reset()},"data-tooltip":e.overrideTooltips?.reset??"Reset","data-placement":"bottom",children:"\u23ee"})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:"normal"},children:[(0,n.jsx)("span",{style:{padding:"0.2rem"},children:"Slow"}),(0,n.jsx)("input",{type:"range",min:0,max:4,step:1,value:s,disabled:t.state.running,onChange:t=>{const s=Number(t.target.value);i(s),e.onSpeedChange?.(s)},style:{width:"150px",padding:"0.2rem"},"data-tooltip":"Execution speed","data-placement":"bottom"}),(0,n.jsx)("span",{style:{padding:"0.2rem"},children:"Fast"})]}),e.children]})}},135:(e,t,s)=>{s.d(t,{Wf:()=>a});var n=s(8281);function r(e){switch(e){case"t":return[...r("tl"),...r("tr")];case"r":return[...r("tr"),...r("br")];case"b":return[...r("br"),...r("bl")];case"l":return[...r("tl"),...r("bl")];default:return[n.Hw[e]]}}function a(e="",t=""){var s;s=e,void 0!==n.Hw[s]&&(t=e,e="");const a=function(e){return n.DN[e]}(e);return r(t).reduce(((e,t)=>(""===t?e.borderRadius=a:e[`border${t}Radius`]=a,e)),{})}},8281:(e,t,s)=>{s.d(t,{DN:()=>n,Hw:()=>r,UL:()=>a});const n={none:"0px",sm:"0.125rem","":"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},r={"":"",t:"Top",r:"Right",l:"Left",b:"Bottom",tl:"TopLeft",tr:"TopRight",bl:"BottomLeft",br:"BottomRight"},a={"1/4":"25%","1/2":"50%","3/4":"75%",full:"100%"}},1091:(e,t,s)=>{s.d(t,{M:()=>r});const n=s(3096).z.get();class r{frame(){this.tick(),this.finishFrame()}finishFrame(){n.frame()}steps=1;speed=1e3;get running(){return this.#e}#e=!1;#t=0;#s=0;#n=async()=>{if(!this.#e)return;const e=Date.now(),t=e-this.#s;if(this.#s=e,this.#t+=t,this.#t>this.speed){let e=!1,t=this.steps;const s=`Timing ${t} steps`;for(console.time(s);!e&&t--;)e=await this.tick();console.timeEnd(s),this.finishFrame(),e&&this.stop(),this.#t-=this.speed}requestAnimationFrame(this.#n)};start(){this.#e=!0,this.#s=Date.now()-this.speed,this.#n(),this.toggle()}stop(){this.#e=!1,this.toggle()}}}}]);